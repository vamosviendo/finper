{% extends 'diario/base.html' %}
{% load static %}

{% block contenido %}

<section id="id_saldos" class="text-center">

  {% block saldo_pag %}
  <div id="id_div_saldo_pag" class="card mt-3 border-danger class_div_totales">
    <div class="card-header bg-danger text-light" id="id_div_titulo_pag">
      <h4>{% block titulo_pag %}{% endblock titulo_pag %}</h4>
    </div>
    <div id="id_div_importe_saldo_pag" class="card-body text-danger numero">
      {% block importe_saldo_pag %}{% endblock importe_saldo_pag %}
    </div>
  </div>
  {% endblock saldo_pag %}

  {% block grid_titulares %}
    <div id="id_grid_titulares" class="card-deck mt-3">
    {% for tit in titulares %}
      <div id="id_div_titular_{{ tit.titname|lower }}" class="card border-success class_div_titular">
        <div class="card-header bg-success text-light class_div_nombre_titular">
          <a href="{% url 'tit_detalle' tit.pk %}" class="text-light class_link_titular" >
            {{ tit.nombre }}
          </a>
        </div>
        <div id="id_patrimonio_{{ tit.titname }}" class="card-body text-success numero class_patrimonio_titular">
          {{ tit.patrimonio|floatformat:2 }}
        </div>
        <div class="card-footer">
          <a href="{% url 'tit_elim' tit.pk %}"
             class="btn btn-danger btn-sm link_elim_titular">Borrar</a>
          <a href="TODO"
             class="btn btn-primary btn-sm link_mod_titular">
            Edit
          </a>
        </div>

      </div>
    {% endfor %}
    </div>
    {% block titular_nuevo %}
    <a href="{% url 'tit_nuevo' %}" id="id_link_titular_nuevo"
       class="class_link_titular btn my-3 btn-primary">
      Titular nuevo
    </a>
    {% endblock titular_nuevo %}
  {% endblock grid_titulares %}

  {% block grid_cuentas %}
  <div id="id_grid_cuentas" class="card-deck mt-3">

    {% for subc in subcuentas %}
    <div id="id_div_cta_{{ subc.slug|lower }}" class="card border-danger class_div_cuenta">
      <div class="card-header bg-danger text-light class_nombre_cuenta">
        <a href="{% url 'cta_detalle' subc.slug %}" class="text-light class_link_cuenta" title="{{subc.nombre}}">
          {{ subc.slug|upper }}
        </a>
      </div>
      <div id="id_saldo_cta_{{ subc.slug|lower }}" class="card-body text-danger numero class_saldo_cuenta">
        {{ subc.saldo|floatformat:2}}
      </div>
      <div class="card-footer">
        <a href="{% url 'cta_elim' subc.slug %}"
           class="btn btn-danger btn-sm link_elim_cuenta">Borrar</a>
        <a href="{% url 'cta_mod' subc.slug %}"
           class="btn btn-primary btn-sm link_mod_cuenta">
          Edit
        </a>
      </div>
    </div>
    {% endfor %}
  </div>
  {% endblock grid_cuentas %}

  <a href="{% url 'cta_nueva' %}" id="id_btn_cta_nueva" class="btn my-3 btn-primary">
    Cuenta nueva
  </a>

  {% block verificar_saldos %}
  {% endblock verificar_saldos %}
</section>

<section id="id_lista_ult_movs">
  <a href="{% url 'mov_nuevo' %}" id="id_btn_mov_nuevo" class="btn my-3 btn-primary">
    Movimiento nuevo
  </a>
  <table class="table table-sm">
    <thead><tr>
      <th>Fecha</th>
      <th>Concepto</th>
      <th class="d-none d-md-table-cell">Detalle</th>
      <th>Importe</th>
      <th>Cuentas</th>
    </tr></thead>
    {% for mov in movimientos reversed %}
    <tr class="class_row_mov">
      <td class="align-middle class_td_fecha" style="width: 8%;">{{ mov.fecha|date:'Y-m-d' }}</td>
      <td class="align-middle class_td_concepto"  style="width: 50ch" title="{{ mov.detalle }}" >
          {{ mov.concepto }}
      </td>
      <td class="d-none d-md-table-cell align-middle class_td_detalle" title="{{mov.detalle}}" style="width: 30%;">
        {{ mov.detalle|default_if_none:""|truncatechars:50 }}
      </td>
      <td class="align-middle text-right
                 {% include './snippets/color_saldo.html' %}
                 numero class_td_importe"
          style="width: 9%;">
        {{ mov.importe|floatformat:2 }}
      </td>
      <td class="small align-middle class_td_cuentas"
          title="{% include './snippets/cuentas_mov.html' %}"
          style="width: 9%;">
        {% if mov.cta_entrada %}+{{ mov.cta_entrada.slug }}{% endif %}
        {% if mov.cta_salida %}-{{ mov.cta_salida.slug }}{% endif %}
      </td>
      <td class="align-middle class_td_menu">
        <a href="{% url 'mov_elim' mov.id %}"
           class="btn btn-danger btn-sm link_elim_mov">
          Borrar
        </a>
        <a href="{% url 'mov_mod' mov.id %}"
           class="btn btn-primary btn-sm link_mod_mov">
          Edit
        </a>
      </td>
    </tr>
    {% endfor %}
  </table>
</section>

{% endblock contenido %}

{% block extrajs %}
<script>
  $(document).ready(function(){
    $('[data-toggle="tooltip"]').tooltip();
  });
</script>
{% endblock extrajs %}